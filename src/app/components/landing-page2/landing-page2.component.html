<div class="landing-container">
<!-- src/app/landing-page/landing-page.component.html -->
<!-- ---------- SLIDER ---------- -->
<div *ngIf="slides.length"  style="width:100%;">
  <div class="slider-wrapper" >
    <button class="nav prev" (click)="prevSlide()">&#10094;</button>

    <div 
      class="slider-scroll"
      #sliderScroll
      (mouseenter)="pauseAuto()"
      (mouseleave)="resumeAuto()"
    >
      <div
        class="slide"
        *ngFor="let s of slides; let i = index"
        [class.active-slide]="i === currentSlideIndex"
      >
      <ng-container *ngIf="externalVideo; else localMedia">
        <div class="video-container">
          <iframe
          [src]="safeUrl"
          title="YouTube video player"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>
        </div>
      </ng-container>

        <!-- interné video / obrázok -->
        <ng-template #localMedia>
          <ng-container *ngIf="s.videos?.length; else imgTpl">
            <video
            #slideVideo
            class="slide-media"
            playsinline
            loop
            autoplay
            [muted]="true"
            (loadedmetadata)="onVideoReady($event)"
            [volume]="0"  
            poster="https://medusa-majolika-s3-us-east.s3.us-east-1.amazonaws.com/products/medium_placeholder_6982996b8f.jpg"
          >
            <source [src]="s.videos[0]" type="video/mp4" />
            {{ 'VIDEO.NOT_SUPPORTED' | translate }}
          </video>
          </ng-container>
          <ng-template #imgTpl>
            <img
              class="slide-media"
              [src]="s.images[0] || '/assets/img/gall/placeholder.jpg'"
              alt="{{ s.title || 'Slide image' }}"
            />
          </ng-template>
        </ng-template>

        <div class="slide-overlay"  [@overlayAnimation]="i">
          <h2 style="width: 100%; max-width: 666px;"  *ngIf="s.title">{{ s.title }}</h2>
          <p style="width: 100%; max-width: 666px;" *ngIf="s.subtitle">{{ s.subtitle }}</p>
          <button
            type="button"
            class="slider-button"
            (click)="goToLink(s.url)"
          >
          <span class="slider-button__text">
            {{ 'ESHOP.BUTTON' | translate }}
          </span>            </button>
        </div>
      </div>
    </div>

    <button class="nav next" (click)="nextSlide()">&#10095;</button>

    <!-- SWIPER-LIKE PAGINATION BULLETS -->
    <div class="swiper-pagination">
      <span
        class="swiper-pagination-bullet"
        *ngFor="let _ of slides; let i = index"
        [class.swiper-pagination-bullet-active]="i === currentSlideIndex"
        (click)="goToSlide(i)"
      ></span>
    </div>
  </div>
</div>

<div style="position: relative; top: -90px;margin:0px;padding:0px;margin-bottom:-90px;">
  <img
    src="/assets/img/back_dekor_black2.png"
    alt="dekor"
    width="104"
    style="transform: rotate(90deg)"
  />
</div>

  <!-- ---------- DVE KARTY ---------- -->
  <div class="choice-grid">
    <div class="choice-card">
      <a routerLink="/eshop/categories/prehliadky">

      <div class="image-wrapper">
        <img src="https://medusa-majolika-s3-us-east.s3.us-east-1.amazonaws.com/products/large_prehliadky_7be0195e2e.webp" alt="E-shop" />
      </div>
      <button class="choice-button">{{ 'PREHLIADKY2.PREHLIADKY2' | translate }}</button>
      </a>
    </div>

    <div class="choice-card" >
      <a routerLink="/eshop/categories/dielne">

      <div class="image-wrapper">
        <img
          src="https://medusa-majolika-s3-us-east.s3.us-east-1.amazonaws.com/products/large_info_majolika_18fd542a5c.jpg"
          alt="Prehliadky/dielne"
        />
      </div>
      <button class="choice-button">{{ 'PREHLIADKY2.DIELNE2' | translate }}</button>
</a>
      <!-- <button class="choice-button">{{ 'CALENDAR.TITLE' | translate }}</button> -->
    </div>
    </div>




      <div class="choice-grid" [@fadeInStagger]="animationState">
        <div class="choice-card">
          <a routerLink="/article/majolika-na-akcii">
          <div class="image-wrapper">

        <img
          src="https://medusa-majolika-s3-us-east.s3.us-east-1.amazonaws.com/products/medium_Bannery_lennaskok_sk_960x540_keramika_6996533b29.png"
          alt="Prehliadky/dielne"
        />
          </div>
      <button class="choice-button">{{ 'PREHLIADKY2.MAJOLIKA_NA_AKCII' | translate }}</button>

      <!-- <button class="choice-button">{{ 'CALENDAR.TITLE' | translate }}</button> -->
    </a>
    </div>

    <div class="choice-card" (click)="onSelect('optionB')">
      <a routerLink="/article/informacie">

      <div class="image-wrapper">
        <img
          src="/assets/img/gall/slovenska_ludova_majolika_2.webp"
          alt="Prehliadky/dielne"
        />
      </div>
      <button class="choice-button">{{ 'PREHLIADKY2.INFO' | translate }}</button>
      <!-- <button class="choice-button">{{ 'CALENDAR.TITLE' | translate }}</button> -->
       </a>
    </div>
  </div>


  <!-- ---------- KALENDÁR & PRAVÝ STĹPEC ---------- -->
  <section
    class="calendar-section"
    [@fadeIn]="'visible'"
    [@slideUp]="'visible'"
    style="margin-top:34px;"
  >
    <h2
      style="text-align:center;font-weight:600; font-size:2.8rem; color:#2943ba59;"
    >
      {{ 'CALENDAR.TITLE' | translate }}
    </h2>

    <div class="month-navigation">
      <button class="month-btn" (click)="prevMonth()">&larr;</button>
      <span class="month-label">
        {{ currentMonth | date:'LLLL yyyy':undefined:lang.getCurrentLanguage() }}
      </span>
      <button class="month-btn" (click)="nextMonth()">&rarr;</button>
    </div>

    <div class="calendar-container">
      <div class="calendar-left">
        <div class="calendar-grid calendar-header">
          <div class="calendar-cell header-cell" *ngFor="let d of weekDayDates">
            {{ d | date: 'EEE': undefined:lang.getCurrentLanguage() }}
          </div>
        </div>
        <div class="calendar-grid">
          <div
          class="calendar-cell"
          *ngFor="let day of calendarDays"
          [class.not-current-month]="!day.isInCurrentMonth"
          [class.today]="day.isToday"
          [class.occupied]="day.isOccupied"
          [class.selectable]="day.isSelectable"
          [class.selected]="isSelected(day)"
          (click)="selectDay(day)"
        >
          {{ day.dayOfMonth }}
        </div>
        </div>
      </div>



      
      <div class="calendar-right flex-center" #formCard style="text-align:left;">
        <ng-container *ngIf="selectedDay; else expTpl">
          <div *ngIf="selectedDay" class="form-card">
            <h1 >
              <!-- {{ 'CALENDAR.REGISTER_TITLE' | translate }} -->
              {{ selectedDay.date | date:'d. MMMM yyyy':undefined:lang.getCurrentLanguage() }}
            </h1>
          
            <div *ngIf="loadingSessions">{{ 'BASE.LOADING_SESSION' | translate }}</div>
            <div *ngIf="!loadingSessions && sessionsForSelectedDay.length === 0">
              {{ 'BASE.NO_TOURS_OR_WORKSHOPS' | translate }}
            </div>
          
            <div *ngFor="let session of sessionsForSelectedDay" class="session-simple-row">
              <!-- Volanie loaderu obrázka (musí byť na začiatku cyklu!) -->
              <ng-container *ngIf="loadProductImageForSession(session) === undefined"></ng-container>
              
              <!-- Obrázok vľavo (bez erroru) -->
              <ng-container *ngIf="session.product?.id as productId">
                <img
                  *ngIf="sessionProductImages[productId]"
                  [src]="sessionProductImages[productId]"
                  [alt]="session.product?.name"
                  class="session-img"
                  (click)="goToLink('eshop/' + session.product?.slug)"
                  
                />
              </ng-container>
            
              <!-- Ostatné vpravo -->
              <div class="session-content">
                <div style="padding-left: 10px;">
                  <h3>{{ session.title || session.product?.name }}</h3>
                </div>
                  <div style="padding-left: 10px;margin-top:-15px;">
                    <span>
                      <i class="fa fa-clock"></i> {{ session.startDateTime | date:'HH:mm':undefined:lang.getCurrentLanguage() }}
                      ( {{ 'BASE.TRVANIE' | translate }}: {{ session.durationMinutes }} min)
                    </span><span>{{ getSessionPrice(session) | number:'1.2-2' }} €</span>
                </div>
                    <div class="session-actions" style="padding: 0px;margin-top:-20px;">
                  <button
                    class="btn"
                    type="button"
                    *ngIf="session.product?.slug"
                    (click)="goToLink('eshop/' + session.product?.slug)">
                    {{ 'BASE.VIAC_INFO' | translate }}
                  </button>
                  <button class="btn"
                    type="button"
                    [disabled]="session.capacity?.available === 0"
                    (click)="startBooking(session)">
                    {{ session.capacity?.available
                      ? ('BASE.ADD_TO_CART_HOLD' | translate:{ available: session.capacity?.available })
                      : ('BASE.FULL' | translate) }}
                  </button>
                </div>
                <div style="position:relative; top:0px;margin-top:-10px;margin-bottom:-40px;">
                  <img src="/assets/img/back_dekor_black2.png" alt="dekor" width="64" style="transform: rotate(90deg);">
                </div>
              </div>
             </div>
          
            <div *ngIf="feedbackKey === 'login_required'">
              {{ 'feedback.login_required' | translate }}<br>
              <a routerLink="/account"> {{ 'feedback.login_to_book' | translate }}</a> {{ 'BASE.OR' | translate }} <a routerLink="/register"> {{ 'feedback.register_to_book' | translate }}</a>
            </div>
          </div>



        </ng-container>

        <ng-template #expTpl>
          <div class="experience-list" *ngIf="experiences.length">
            <a
              class="experience-card"
              *ngFor="let p of experiences"
              [routerLink]="['/eshop', p.slug]"
            >
              <img [src]="p.primaryImageUrl" [alt]="p.name" />
              <span>{{ p.name }}</span>
            </a>
          </div>
        </ng-template>
      </div>
    </div>
  </section>

  <!-- -------  DEKOR + ODKAZY ------- -->
  <div style="position: relative; top: 0">
    <img
      src="/assets/img/back_dekor_black2.png"
      alt="dekor"
      width="104"
      style="transform: rotate(90deg)"
    />
  </div>

  <div
    class="buttons2 mb-4"
    style="position: relative; display: flex; top: 0"
  >
    <a
      routerLink="/eshop"
      style="display:block; width:100px;height:100px;"
      >{{ 'HOME.ESHOP' | translate }}</a
    >
    <a
      routerLink="/dielne"
      style="display:block; width:100px;height:100px;"
      >{{ 'HOME.DIELNE' | translate }}</a
    >
    <a
      routerLink="/tradicia"
      style="display:block; width:100px;height:100px;"
      >{{ 'HOME.TRADICIA' | translate }}</a
    >
  </div>

  <p class="mt-4" style="text-align: center; width: 100%; max-width: 666px; margin: auto;">
    {{ 'ESHOP.FIRST_TEXT' | translate }}
  </p>
</div>

<app-footer></app-footer>
